async function init() { if (!isSessionValid()) { localStorage.clear(); window.location.href = 'auth.html'; return; } const token = localStorage.getItem('token'); if (!token) { window.location.href = 'auth.html'; return; } try { await loadUserProfile(); await loadSettings(); connectWebSocket(token); } catch (error) { console.error('Init error:', error); } } window.addEventListener('load', init);