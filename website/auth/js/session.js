function isSessionValid() { const token = localStorage.getItem('token'); const loginTime = localStorage.getItem('loginTime'); if (!token || !loginTime) { return false; } const now = Date.now(); const elapsed = now - parseInt(loginTime); if (elapsed > SESSION_CONFIG.TIMEOUT) { localStorage.removeItem('token'); localStorage.removeItem('user'); localStorage.removeItem('loginTime'); return false; } return true; } function checkExistingSession() { if (isSessionValid()) { const user = JSON.parse(localStorage.getItem('user')); if (user.role === 'admin') { window.location.href = 'admin-dash.html'; } else { window.location.href = 'dash.html'; } } } window.addEventListener('load', checkExistingSession);
